{"ast":null,"code":"import { isSignal, untracked } from '@angular/core';\nimport { selectSignal } from './select-signal';\nexport function toDeepSignal(signal) {\n  const value = untracked(() => signal());\n  if (!isRecord(value)) {\n    return signal;\n  }\n  return new Proxy(signal, {\n    get(target, prop) {\n      if (prop in value && !target[prop]) {\n        target[prop] = selectSignal(() => target()[prop]);\n      }\n      return isSignal(target[prop]) ? toDeepSignal(target[prop]) : target[prop];\n    }\n  });\n}\nfunction isRecord(value) {\n  return value?.constructor === Object;\n}","map":{"version":3,"names":["isSignal","untracked","selectSignal","toDeepSignal","signal","value","isRecord","Proxy","get","target","prop","constructor","Object"],"sources":["/home/jonatanMelzer/products-search-store/src/lib/deep-signal.ts"],"sourcesContent":["import { isSignal, Signal, untracked } from '@angular/core';\nimport { selectSignal } from './select-signal';\n\nexport type DeepSignal<T> = Signal<T> &\n  (T extends Record<string, unknown>\n    ? Readonly<{ [K in keyof T]: DeepSignal<T[K]> }>\n    : unknown);\n\nexport function toDeepSignal<T>(signal: Signal<T>): DeepSignal<T> {\n  const value = untracked(() => signal());\n  if (!isRecord(value)) {\n    return signal as DeepSignal<T>;\n  }\n\n  return new Proxy(signal, {\n    get(target: any, prop) {\n      if (prop in value && !target[prop]) {\n        target[prop] = selectSignal(() => target()[prop]);\n      }\n\n      return isSignal(target[prop]) ? toDeepSignal(target[prop]) : target[prop];\n    },\n  });\n}\n\nfunction isRecord(value: unknown): value is Record<string, unknown> {\n  return value?.constructor === Object;\n}\n"],"mappings":"AAAA,SAASA,QAAQ,EAAUC,SAAS,QAAQ,eAAe;AAC3D,SAASC,YAAY,QAAQ,iBAAiB;AAO9C,OAAM,SAAUC,YAAYA,CAAIC,MAAiB;EAC/C,MAAMC,KAAK,GAAGJ,SAAS,CAAC,MAAMG,MAAM,EAAE,CAAC;EACvC,IAAI,CAACE,QAAQ,CAACD,KAAK,CAAC,EAAE;IACpB,OAAOD,MAAuB;;EAGhC,OAAO,IAAIG,KAAK,CAACH,MAAM,EAAE;IACvBI,GAAGA,CAACC,MAAW,EAAEC,IAAI;MACnB,IAAIA,IAAI,IAAIL,KAAK,IAAI,CAACI,MAAM,CAACC,IAAI,CAAC,EAAE;QAClCD,MAAM,CAACC,IAAI,CAAC,GAAGR,YAAY,CAAC,MAAMO,MAAM,EAAE,CAACC,IAAI,CAAC,CAAC;;MAGnD,OAAOV,QAAQ,CAACS,MAAM,CAACC,IAAI,CAAC,CAAC,GAAGP,YAAY,CAACM,MAAM,CAACC,IAAI,CAAC,CAAC,GAAGD,MAAM,CAACC,IAAI,CAAC;IAC3E;GACD,CAAC;AACJ;AAEA,SAASJ,QAAQA,CAACD,KAAc;EAC9B,OAAOA,KAAK,EAAEM,WAAW,KAAKC,MAAM;AACtC"},"metadata":{},"sourceType":"module","externalDependencies":[]}