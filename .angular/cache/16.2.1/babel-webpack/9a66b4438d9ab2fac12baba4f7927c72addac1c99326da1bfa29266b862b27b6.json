{"ast":null,"code":"import { signal } from '@angular/core';\nimport { toDeepSignal } from './deep-signal';\nimport { defaultEqualityFn } from './select-signal';\nexport function signalState(initialState) {\n  const stateSignal = signal(initialState, {\n    equal: defaultEqualityFn\n  });\n  const deepSignal = toDeepSignal(stateSignal.asReadonly());\n  deepSignal.$update = signalStateUpdateFactory(stateSignal);\n  return deepSignal;\n}\nexport function signalStateUpdateFactory(stateSignal) {\n  return (...updaters) => stateSignal.update(state => updaters.reduce((currentState, updater) => ({\n    ...currentState,\n    ...(typeof updater === 'function' ? updater(currentState) : updater)\n  }), state));\n}","map":{"version":3,"names":["signal","toDeepSignal","defaultEqualityFn","signalState","initialState","stateSignal","equal","deepSignal","asReadonly","$update","signalStateUpdateFactory","updaters","update","state","reduce","currentState","updater"],"sources":["/home/jonatanMelzer/products-search-store/src/lib/signal-state.ts"],"sourcesContent":["import { signal, WritableSignal } from '@angular/core';\nimport { toDeepSignal } from './deep-signal';\nimport { defaultEqualityFn } from './select-signal';\nimport {\n  NotAllowedStateCheck,\n  SignalState,\n  SignalStateUpdate,\n} from './signal-state-models';\n\nexport function signalState<State extends Record<string, unknown>>(\n  initialState: State & NotAllowedStateCheck<State>\n): SignalState<State> {\n  const stateSignal = signal(initialState as State, {\n    equal: defaultEqualityFn,\n  });\n  const deepSignal = toDeepSignal(stateSignal.asReadonly());\n  (deepSignal as SignalState<State>).$update =\n    signalStateUpdateFactory(stateSignal);\n\n  return deepSignal as SignalState<State>;\n}\n\nexport function signalStateUpdateFactory<State extends Record<string, unknown>>(\n  stateSignal: WritableSignal<State>\n): SignalStateUpdate<State>['$update'] {\n  return (...updaters) =>\n    stateSignal.update((state) =>\n      updaters.reduce(\n        (currentState: State, updater) => ({\n          ...currentState,\n          ...(typeof updater === 'function' ? updater(currentState) : updater),\n        }),\n        state\n      )\n    );\n}\n"],"mappings":"AAAA,SAASA,MAAM,QAAwB,eAAe;AACtD,SAASC,YAAY,QAAQ,eAAe;AAC5C,SAASC,iBAAiB,QAAQ,iBAAiB;AAOnD,OAAM,SAAUC,WAAWA,CACzBC,YAAiD;EAEjD,MAAMC,WAAW,GAAGL,MAAM,CAACI,YAAqB,EAAE;IAChDE,KAAK,EAAEJ;GACR,CAAC;EACF,MAAMK,UAAU,GAAGN,YAAY,CAACI,WAAW,CAACG,UAAU,EAAE,CAAC;EACxDD,UAAiC,CAACE,OAAO,GACxCC,wBAAwB,CAACL,WAAW,CAAC;EAEvC,OAAOE,UAAgC;AACzC;AAEA,OAAM,SAAUG,wBAAwBA,CACtCL,WAAkC;EAElC,OAAO,CAAC,GAAGM,QAAQ,KACjBN,WAAW,CAACO,MAAM,CAAEC,KAAK,IACvBF,QAAQ,CAACG,MAAM,CACb,CAACC,YAAmB,EAAEC,OAAO,MAAM;IACjC,GAAGD,YAAY;IACf,IAAI,OAAOC,OAAO,KAAK,UAAU,GAAGA,OAAO,CAACD,YAAY,CAAC,GAAGC,OAAO;GACpE,CAAC,EACFH,KAAK,CACN,CACF;AACL"},"metadata":{},"sourceType":"module","externalDependencies":[]}